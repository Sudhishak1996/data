#### Copyright 2025 Google LLC
####
#### Licensed under the Apache License, Version 2.0 (the "License");
#### you may not use this file except in compliance with the License.
#### You may obtain a copy of the License at
####
####    https://www.apache.org/licenses/LICENSE-2.0
####
#### Unless required by applicable law or agreed to in writing, software
#### distributed under the License is distributed on an "AS IS" BASIS,
#### WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#### See the License for the specific language governing permissions and
#### limitations under the License.

-----

## NYU_Tennesse_Diabetes Import

This import utilizes official mortality data from the Tennessee Department of Health, detailing county-level death statistics categorized by race, and separately, race by sex.

-----

### ⚙️ Workflow

The workflow for this data import involves two main steps: downloading the necessary files and then processing them.

#### Step 1: Download the Source Data

To acquire the necessary data files, execute the download script `download.py`.

All downloaded files will be stored in the primary directory `input_files` and automatically categorized into three subfolders: `race`, `race_male`, and `race_female`.

### Autorefresh type

This import uses a fully automated refresh process.

-----

#### Step 2: Process the Files

After successfully downloading the files, run the processing script to generate the final output artifacts.

#### **Execution Commands**

The final output is generated by processing the downloaded data using the stat_var_processor.py script, which is located in the data/tools/statvar_importer/ directory. You will run this script once for each data category:

    ```bash
    python3 stat_var_processor.py \
    --input_data=../../statvar_imports/nyu_diabetes/tennesse/input_files/race_female/*.xlsx \
    --pv_map=../../statvar_imports/nyu_diabetes/tennesse/race_female_pvmap.csv \
    --config_file=../../statvar_imports/nyu_diabetes/tennesse/metadata.csv \
    --output_path=../../statvar_imports/nyu_diabetes/tennesse/output_files/race_female_output \
    --existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
    --places_resolved_csv=place_resolver.csv
    ```

    ```bash
    python3 stat_var_processor.py \
    --input_data=../../statvar_imports/nyu_diabetes/tennesse/input_files/race_male/*.xlsx \
    --pv_map=../../statvar_imports/nyu_diabetes/tennesse/race_male_pvmap.csv \
    --config_file=../../statvar_imports/nyu_diabetes/tennesse/metadata.csv \
    --output_path=../../statvar_imports/nyu_diabetes/tennesse/output_files/race_male_output \
    --existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
    --places_resolved_csv=place_resolver.csv
    ```

    ```bash
    python3 stat_var_processor.py \
    --input_data=../../statvar_imports/nyu_diabetes/tennesse/input_files/race/*.xlsx \
    --pv_map=../../statvar_imports/nyu_diabetes/tennesse/race_pvmap.csv \
    --config_file=../../statvar_imports/nyu_diabetes/tennesse/metadata.csv \
    --output_path=../../statvar_imports/nyu_diabetes/tennesse/output_files/race_output \
    --existing_statvar_mcf=gs://unresolved_mcf/scripts/statvar/stat_vars.mcf \
    --places_resolved_csv=place_resolver.csv
    ```
